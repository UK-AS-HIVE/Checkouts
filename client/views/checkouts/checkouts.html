<template name="checkouts">
{{#if isAdmin}}
{{> checkoutDialog}}
{{> itemDialog}}
{{> deleteItemDialog}}
{{/if}}
{{> reserveDialog}}
<table class="table table-striped table-condensed" style="border-collapse:collapse;">
  <thead>
    <tr>
      <th>&nbsp;</th>
      <th>Picture</th>
      <th>Name</th>
      <th class="hidden-xs">Item Type</th>
      <th>Checked Out</th>
    </tr>
  </thead>
  <tbody>
    <tr></tr>
    {{#each checkoutItem}}
    {{> checkoutRow}}
    {{/each}}
  </tbody>
</table>
</template>

<template name="checkoutButtons">
<button class="checkoutBtn pull-left btn-success btn btn-sm" id="checkOutButton">Scan a Barcode</button>
</template>

<template name="checkoutRow">
<tr data-toggle="collapse" data-target="#row{{_id}}" class="accordion-toggle">
  <td>
    <span class="glyphicon glyphicon-plus" name="{{_id}}"></span>
  </td>
  <td>
    {{#if thumbnailUrl}}<img style="max-height: 50px;" src="{{rootUrl}}/file/{{thumbnailUrl}}">{{/if}}
  </td>
  <td>
    <strong>{{name}}</strong>
  </td>
  <td class="hidden-xs">
    {{category}}
  </td>
  <td>
    {{#if assignedTo}}<span class="unavailable">
      {{#if isAdmin}}
      Checked out to: {{assignedTo}}
      {{else}}
      Unavailable
      {{/if}}</span>
    {{else}}
    <span class="available">{{#if dateReserved}}Reserved: {{dateReserved}}{{else}}Available{{/if}}</span>
    {{/if}}
  </td>
</tr>
<tr>
  <td colspan='7' class="hiddenRow">
    <div class="accordion-body collapse" id="row{{_id}}" name="{{_id}}">
      <div class="row">
        <div class="col-xs-12 col-md-6 col-md-offset-4">
          {{#if isAdmin}}
          <!-- Admin Buttons -->
          <button type="button" class="checkoutItemBtn pull-left btn-success btn btn-sm" data-item="{{_id}}">{{#if assignedTo}}Check In{{else}}Check Out{{/if}}</button>
          {{#unless reservation.assignedTo}}
          <button type="button" class="reserveItemBtn pull-right btn-success btn btn-sm" data-item="{{_id}}">Reserve Item</button>
          {{else}}
          <button type="button" class="cancelReserveBtn pull-right btn-danger btn btn-sm" data-item="{{_id}}">Cancel Reservation</button>
          {{/unless}}
          {{else}}
          <!-- Non-Admin Buttons -->
          {{#unless reservation.assignedTo}}
          <button type="button" class="reserveItemBtn pull-right btn-success btn btn-sm" data-item="{{_id}}">Reserve Item</button>
          {{/unless}}
          {{#if assignedToMe}}
          <button type="button" class="cancelReserveBtn pull-right btn-danger btn btn-sm" data-item="{{_id}}">Cancel Reservation</button>
          {{/if}}
          {{/if}}
        </div>
      </div>
      <form class="form-horizontal">
        {{#if expectedReturn}}
        <div class="form-group">
          <label for="expectedReturn" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Expected Return:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{expectedReturn}}" name="expectedReturn" id="{{_id}}expectedReturn" class="form-control" disabled>
          </div>
        </div>
        {{/if}}
        {{#if reservation.expectedReturn}}
        <div class="form-group">
          <label for="resExpectedReturn" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Expected Return:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{reservation.expectedReturn}}" name="resExpectedReturn" id="{{_id}}resExpectedReturn" class="form-control" disabled>
          </div>
        </div>
        {{/if}}
        <div class="form-group">
          <label for="description" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Description:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{description}}" name="description" id="{{_id}}description" class="form-control" disabled>
          </div>
        </div>
        {{#if isAdmin}}
        {{#if reservation.assignedTo}}
        <div class="form-group">
          <label for="resAssignedTo" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Reserved To:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{reservation.assignedTo}}" name="resAssignedTo" id="{{_id}}resAssignedTo" class="form-control" disabled>
          </div>
        </div>
        {{/if}}
        <div class="form-group">
          <label for="serialNo" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Serial No:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{serialNo}}" name="serialNo" id="{{_id}}serialNo" class="form-control" disabled>
          </div>
        </div>
        <div class="form-group">
          <label for="propertyTag" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Property Tag:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{propertyTag}}" name="propertyTag" id="{{_id}}propertyTag" class="form-control" disabled>
          </div>
        </div>
        <div class="form-group">
          <label for="barcode" class="col-xs-4 col-md-2 col-md-offset-2 control-label">Barcode:</label>
          <div class="col-xs-8 col-md-6">
            <input type="text" value="{{barcode}}" name="{{barcode}}" id="{{_id}}barcode" class="form-control" disabled>
          </div>
        </div>
        {{/if}}
      </form>
      {{#if isAdmin}}
      <div class="row">
        <div class="col-xs-12 col-md-6 col-md-offset-4">
          <button type="button" class="editItemBtn pull-left btn-success btn btn-sm" data-item="{{_id}}">Edit Item</button>
          <button type="button" class="deleteItemBtn pull-right btn btn-danger btn-sm" data-item="{{_id}}">Delete Item</button>
        </div>
      </div>
      {{/if}}
    </div>
  </td>
</tr>
</template>
